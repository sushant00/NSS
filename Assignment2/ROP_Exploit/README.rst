SIMPLE ROP EXPLOIT
*******************

.. contents:: **Contents of this document**
   :depth: 2


Description
===========
We are given a binary (named 'victim-nonexec-stack') which has SSP turned off and also the stack is non executable. We want to perform a rop exploit. We would force the victim to call the execve system call and eventually halt program to shut the system down.

Get Started
===========

Step 0
------
We would first turn the ASLR off (which is enabled by default on modern systems). We add the line **kernel.randomize_va_space=0** to end of file **/etc/sysctl.conf** and apply the changes by running the following command

.. code:: shell

	sysctl -p

Step 1
------
We would now generate the input to pass to the vicitm

.. code:: shell

	sh gen_input.sh

Step 2
-------
Finally, exploit the victim program

.. code:: shell

	./victim < input
	


Implementation
==============
./victim-nonexec-stack

in other terminal
ps -C victim-nonexec-stack

check the pid from above

cat /proc/<pid>/maps

observe map of the libc





Reference
=========
https://github.com/finallyjustice/security/tree/master/rop/demo1
https://github.com/JonathanSalwan/ROPgadget


Author: Sushant Kumar Singh